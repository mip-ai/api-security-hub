<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OWASP API Security Top 10 - API Security Reference Hub</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>

  <div class="page-header">
    <h1>OWASP API Security Top 10 (2023)</h1>
    <p class="subtitle">APIã«ç‰¹åŒ–ã—ãŸæœ€ã‚‚é‡è¦ãª10ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒªã‚¹ã‚¯ã¨ã€ãã®å¯¾ç­–æ–¹æ³•ã‚’è§£èª¬ã—ã¾ã™ã€‚</p>
  </div>

  <!-- Overview -->
  <div class="section">
    <div class="callout callout-info">
      <div class="callout-title">OWASP API Security Top 10 ã¨ã¯</div>
      <p>OWASPï¼ˆOpen Worldwide Application Security Projectï¼‰ãŒå…¬é–‹ã™ã‚‹APIå›ºæœ‰ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒªã‚¹ã‚¯ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã§ã™ã€‚2023å¹´ç‰ˆã§ã¯ã€APIã®æ™®åŠã«ä¼´ã„å¢—åŠ ã™ã‚‹è„…å¨ã‚’åæ˜ ã—ãŸæœ€æ–°ã®ãƒªã‚¹ãƒˆãŒæä¾›ã•ã‚Œã¦ã„ã¾ã™ã€‚</p>
    </div>
  </div>

  <!-- API1: BOLA -->
  <div class="section">
    <h2><span class="section-icon">1ï¸âƒ£</span> API1:2023 - Broken Object Level Authorization (BOLA)</h2>
    <span class="badge badge-danger">Critical</span>

    <h3>æ¦‚è¦</h3>
    <p>ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆIDã‚’æ“ä½œã™ã‚‹ã“ã¨ã§ã€ä»–ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ‡ãƒ¼ã‚¿ã«ä¸æ­£ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹è„†å¼±æ€§ã§ã™ã€‚æœ€ã‚‚é »å‡ºã‹ã¤æ‚ªç”¨ãŒå®¹æ˜“ãªè„†å¼±æ€§ã¨ã—ã¦çŸ¥ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚</p>

    <div class="callout callout-danger">
      <div class="callout-title">ãƒªã‚¹ã‚¯</div>
      <p>æ”»æ’ƒè€…ã¯URLã‚„ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®IDã‚’å¤‰æ›´ã™ã‚‹ã ã‘ã§ã€ä»–ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å€‹äººæƒ…å ±ãƒ»æ±ºæ¸ˆæƒ…å ±ãƒ»æ³¨æ–‡å±¥æ­´ãªã©ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¦ã—ã¾ã„ã¾ã™ã€‚</p>
    </div>

    <h3>è„†å¼±ãªã‚³ãƒ¼ãƒ‰ä¾‹</h3>
    <div class="code-block">
      <div class="code-block-header">
        <span class="lang">JavaScript (Express)</span>
        <span>âŒ Bad</span>
      </div>
      <pre><span class="comment">// IDã‚’å—ã‘å–ã£ã¦ãã®ã¾ã¾è¿”ã™ - èªå¯ãƒã‚§ãƒƒã‚¯ãªã—</span>
app.<span class="function">get</span>(<span class="string">'/api/users/:id/orders'</span>, <span class="keyword">async</span> (req, res) =&gt; {
  <span class="keyword">const</span> orders = <span class="keyword">await</span> Order.<span class="function">find</span>({ userId: req.params.id });
  res.<span class="function">json</span>(orders);
});</pre>
    </div>

    <h3>å®‰å…¨ãªã‚³ãƒ¼ãƒ‰ä¾‹</h3>
    <div class="code-block">
      <div class="code-block-header">
        <span class="lang">JavaScript (Express)</span>
        <span>âœ… Good</span>
      </div>
      <pre><span class="comment">// èªè¨¼æ¸ˆã¿ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®IDã¨ç…§åˆã—ã¦èªå¯ãƒã‚§ãƒƒã‚¯</span>
app.<span class="function">get</span>(<span class="string">'/api/users/:id/orders'</span>, authenticate, <span class="keyword">async</span> (req, res) =&gt; {
  <span class="keyword">if</span> (req.user.id !== req.params.id &amp;&amp; !req.user.isAdmin) {
    <span class="keyword">return</span> res.<span class="function">status</span>(<span class="number">403</span>).<span class="function">json</span>({ <span class="variable">error</span>: <span class="string">'Forbidden'</span> });
  }
  <span class="keyword">const</span> orders = <span class="keyword">await</span> Order.<span class="function">find</span>({ userId: req.params.id });
  res.<span class="function">json</span>(orders);
});</pre>
    </div>

    <h3>å¯¾ç­–ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ</h3>
    <ul class="checklist">
      <li>ã™ã¹ã¦ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ¬ãƒ™ãƒ«ã®èªå¯ãƒã‚§ãƒƒã‚¯ã‚’å®Ÿè£…</li>
      <li>æ¨æ¸¬å¯èƒ½ãªé€£ç•ªIDã§ã¯ãªãUUIDã‚’ä½¿ç”¨</li>
      <li>èªå¯ãƒ­ã‚¸ãƒƒã‚¯ã‚’ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã§ä¸€å…ƒç®¡ç†</li>
      <li>è‡ªå‹•ãƒ†ã‚¹ãƒˆã§èªå¯ãƒã‚¤ãƒ‘ã‚¹ã‚’æ¤œå‡º</li>
    </ul>
  </div>

  <!-- API2: Broken Authentication -->
  <div class="section">
    <h2><span class="section-icon">2ï¸âƒ£</span> API2:2023 - Broken Authentication</h2>
    <span class="badge badge-danger">Critical</span>

    <h3>æ¦‚è¦</h3>
    <p>èªè¨¼ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã®å®Ÿè£…ãƒŸã‚¹ã«ã‚ˆã‚Šã€æ”»æ’ƒè€…ãŒæ­£è¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä¹—ã£å–ã‚Œã¦ã—ã¾ã†è„†å¼±æ€§ã§ã™ã€‚</p>

    <div class="callout callout-danger">
      <div class="callout-title">ã‚ˆãã‚ã‚‹å•é¡Œ</div>
      <p>å¼±ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒªã‚·ãƒ¼ã€ãƒˆãƒ¼ã‚¯ãƒ³ã®ä¸é©åˆ‡ãªç®¡ç†ã€ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹å¯¾ç­–ã®æ¬ å¦‚ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ã®ä¸å‚™ãªã©ã€‚</p>
    </div>

    <div class="code-block">
      <div class="code-block-header">
        <span class="lang">JavaScript</span>
        <span>âœ… å¯¾ç­–ä¾‹: JWTæ¤œè¨¼</span>
      </div>
      <pre><span class="keyword">const</span> jwt = <span class="function">require</span>(<span class="string">'jsonwebtoken'</span>);

<span class="keyword">function</span> <span class="function">authenticate</span>(req, res, next) {
  <span class="keyword">const</span> token = req.headers.authorization?.<span class="function">split</span>(<span class="string">' '</span>)[<span class="number">1</span>];
  <span class="keyword">if</span> (!token) <span class="keyword">return</span> res.<span class="function">status</span>(<span class="number">401</span>).<span class="function">json</span>({ <span class="variable">error</span>: <span class="string">'Token required'</span> });

  <span class="keyword">try</span> {
    <span class="comment">// ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’æ˜ç¤ºçš„ã«æŒ‡å®šï¼ˆalg: none æ”»æ’ƒã‚’é˜²æ­¢ï¼‰</span>
    <span class="keyword">const</span> decoded = jwt.<span class="function">verify</span>(token, process.env.JWT_SECRET, {
      <span class="variable">algorithms</span>: [<span class="string">'HS256'</span>],
      <span class="variable">issuer</span>: <span class="string">'your-app'</span>,
    });
    req.user = decoded;
    <span class="function">next</span>();
  } <span class="keyword">catch</span> (err) {
    res.<span class="function">status</span>(<span class="number">401</span>).<span class="function">json</span>({ <span class="variable">error</span>: <span class="string">'Invalid token'</span> });
  }
}</pre>
    </div>

    <ul class="checklist">
      <li>JWTã®ç½²åæ¤œè¨¼æ™‚ã«ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’æ˜ç¤ºçš„ã«æŒ‡å®š</li>
      <li>ãƒˆãƒ¼ã‚¯ãƒ³ã®æœ‰åŠ¹æœŸé™ã‚’çŸ­ãè¨­å®šï¼ˆã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³: 15åˆ†ä»¥å†…ï¼‰</li>
      <li>ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³ã®ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè£…</li>
      <li>ãƒ­ã‚°ã‚¤ãƒ³è©¦è¡Œå›æ•°ã®åˆ¶é™ã‚’è¨­ã‘ã‚‹</li>
    </ul>
  </div>

  <!-- API3: Broken Object Property Level Authorization -->
  <div class="section">
    <h2><span class="section-icon">3ï¸âƒ£</span> API3:2023 - Broken Object Property Level Authorization</h2>
    <span class="badge badge-warning">High</span>

    <h3>æ¦‚è¦</h3>
    <p>APIãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«å«ã¾ã‚Œã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ï¼ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼‰ã«å¯¾ã™ã‚‹ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ãŒä¸ååˆ†ãªè„†å¼±æ€§ã§ã™ã€‚éå‰°ãªãƒ‡ãƒ¼ã‚¿éœ²å‡ºï¼ˆExcessive Data Exposureï¼‰ã¨ãƒã‚¹ã‚¢ã‚µã‚¤ãƒ³ãƒ¡ãƒ³ãƒˆï¼ˆMass Assignmentï¼‰ã‚’çµ±åˆã—ãŸé …ç›®ã§ã™ã€‚</p>

    <div class="code-block">
      <div class="code-block-header">
        <span class="lang">JavaScript</span>
        <span>âœ… ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°</span>
      </div>
      <pre><span class="comment">// ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰å…¬é–‹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ã¿è¿”ã™</span>
<span class="keyword">function</span> <span class="function">sanitizeUser</span>(user, requesterId) {
  <span class="keyword">const</span> publicFields = { id: user.id, name: user.name, avatar: user.avatar };

  <span class="comment">// æœ¬äººã®ã¿è¿½åŠ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¦‹ã‚Œã‚‹</span>
  <span class="keyword">if</span> (requesterId === user.id) {
    publicFields.email = user.email;
    publicFields.phone = user.phone;
  }

  <span class="keyword">return</span> publicFields;
  <span class="comment">// âŒ return user; ã¨ã™ã‚‹ã¨ password_hash ç­‰ã‚‚æ¼æ´©ã™ã‚‹</span>
}</pre>
    </div>

    <ul class="checklist">
      <li>APIãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«å«ã‚ã‚‹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æ˜ç¤ºçš„ã«æŒ‡å®šï¼ˆallowlistæ–¹å¼ï¼‰</li>
      <li>ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£ã®å—ã‘å…¥ã‚Œãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ã‚¹ã‚­ãƒ¼ãƒã§åˆ¶é™</li>
      <li>ãƒ­ãƒ¼ãƒ«ã«åŸºã¥ã„ã¦ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’å‹•çš„ã«ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°</li>
    </ul>
  </div>

  <!-- API4: Unrestricted Resource Consumption -->
  <div class="section">
    <h2><span class="section-icon">4ï¸âƒ£</span> API4:2023 - Unrestricted Resource Consumption</h2>
    <span class="badge badge-warning">High</span>

    <h3>æ¦‚è¦</h3>
    <p>APIãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ã‚µã‚¤ã‚ºãƒ»é »åº¦ãƒ»ãƒªã‚½ãƒ¼ã‚¹æ¶ˆè²»ã«åˆ¶é™ãŒãªãã€DoSæ”»æ’ƒã‚„ã‚³ã‚¹ãƒˆã®æ€¥é¨°ã‚’å¼•ãèµ·ã“ã™è„†å¼±æ€§ã§ã™ã€‚</p>

    <div class="code-block">
      <div class="code-block-header">
        <span class="lang">JavaScript (Express)</span>
        <span>âœ… ãƒªã‚½ãƒ¼ã‚¹åˆ¶é™ã®å®Ÿè£…</span>
      </div>
      <pre><span class="keyword">const</span> rateLimit = <span class="function">require</span>(<span class="string">'express-rate-limit'</span>);

<span class="comment">// ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ¬ãƒ¼ãƒˆåˆ¶é™</span>
app.<span class="function">use</span>(<span class="function">rateLimit</span>({
  <span class="variable">windowMs</span>: <span class="number">15</span> * <span class="number">60</span> * <span class="number">1000</span>, <span class="comment">// 15åˆ†</span>
  <span class="variable">max</span>: <span class="number">100</span>,                   <span class="comment">// æœ€å¤§100ãƒªã‚¯ã‚¨ã‚¹ãƒˆ</span>
  <span class="variable">standardHeaders</span>: <span class="keyword">true</span>,
}));

<span class="comment">// ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚µã‚¤ã‚ºåˆ¶é™</span>
app.<span class="function">use</span>(express.<span class="function">json</span>({ <span class="variable">limit</span>: <span class="string">'10kb'</span> }));

<span class="comment">// ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ä¸Šé™</span>
app.<span class="function">get</span>(<span class="string">'/api/items'</span>, (req, res) =&gt; {
  <span class="keyword">const</span> limit = Math.<span class="function">min</span>(<span class="function">parseInt</span>(req.query.limit) || <span class="number">20</span>, <span class="number">100</span>);
  <span class="comment">// ...</span>
});</pre>
    </div>
  </div>

  <!-- API5: Broken Function Level Authorization -->
  <div class="section">
    <h2><span class="section-icon">5ï¸âƒ£</span> API5:2023 - Broken Function Level Authorization</h2>
    <span class="badge badge-warning">High</span>

    <h3>æ¦‚è¦</h3>
    <p>ç®¡ç†è€…å‘ã‘æ©Ÿèƒ½ã‚„ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«å¯¾ã™ã‚‹é©åˆ‡ãªã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ãŒå®Ÿè£…ã•ã‚Œã¦ãŠã‚‰ãšã€ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç®¡ç†æ“ä½œã‚’å®Ÿè¡Œã§ãã¦ã—ã¾ã†è„†å¼±æ€§ã§ã™ã€‚</p>

    <div class="code-block">
      <div class="code-block-header">
        <span class="lang">JavaScript</span>
        <span>âœ… ãƒ­ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡</span>
      </div>
      <pre><span class="keyword">function</span> <span class="function">authorize</span>(...roles) {
  <span class="keyword">return</span> (req, res, next) =&gt; {
    <span class="keyword">if</span> (!roles.<span class="function">includes</span>(req.user.role)) {
      <span class="keyword">return</span> res.<span class="function">status</span>(<span class="number">403</span>).<span class="function">json</span>({ <span class="variable">error</span>: <span class="string">'Insufficient permissions'</span> });
    }
    <span class="function">next</span>();
  };
}

<span class="comment">// ç®¡ç†è€…ã®ã¿ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½</span>
app.<span class="function">delete</span>(<span class="string">'/api/admin/users/:id'</span>, authenticate, <span class="function">authorize</span>(<span class="string">'admin'</span>), deleteUser);

<span class="comment">// ç®¡ç†è€…ã¨ãƒ¢ãƒ‡ãƒ¬ãƒ¼ã‚¿ãƒ¼</span>
app.<span class="function">put</span>(<span class="string">'/api/posts/:id/moderate'</span>, authenticate, <span class="function">authorize</span>(<span class="string">'admin'</span>, <span class="string">'moderator'</span>), moderatePost);</pre>
    </div>
  </div>

  <!-- API6: Unrestricted Access to Sensitive Business Flows -->
  <div class="section">
    <h2><span class="section-icon">6ï¸âƒ£</span> API6:2023 - Unrestricted Access to Sensitive Business Flows</h2>
    <span class="badge badge-info">Medium</span>

    <h3>æ¦‚è¦</h3>
    <p>ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ä¸Šã®é‡è¦ãªãƒ•ãƒ­ãƒ¼ãŒè‡ªå‹•åŒ–æ”»æ’ƒã‹ã‚‰ä¿è­·ã•ã‚Œã¦ã„ãªã„è„†å¼±æ€§ã§ã™ã€‚ä¾‹: ãƒã‚±ãƒƒãƒˆã®è²·ã„å ã‚ã€ã‚¯ãƒ¼ãƒãƒ³ã®å¤§é‡å–å¾—ã€ã‚¹ãƒ‘ãƒ æŠ•ç¨¿ãªã©ã€‚</p>

    <h3>å¯¾ç­–</h3>
    <ul class="checklist">
      <li>CAPTCHAãƒ»reCAPTCHAã®å°å…¥</li>
      <li>ãƒ‡ãƒã‚¤ã‚¹ãƒ•ã‚£ãƒ³ã‚¬ãƒ¼ãƒ—ãƒªãƒ³ãƒ†ã‚£ãƒ³ã‚°</li>
      <li>æ“ä½œé »åº¦ã®ãƒ“ã‚¸ãƒã‚¹ãƒ¬ãƒ™ãƒ«ã§ã®åˆ¶é™</li>
      <li>ãƒ’ãƒ¥ãƒ¼ãƒãƒ³ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³ã®æ¤œå‡º</li>
    </ul>
  </div>

  <!-- API7: Server Side Request Forgery -->
  <div class="section">
    <h2><span class="section-icon">7ï¸âƒ£</span> API7:2023 - Server Side Request Forgery (SSRF)</h2>
    <span class="badge badge-warning">High</span>

    <h3>æ¦‚è¦</h3>
    <p>ãƒ¦ãƒ¼ã‚¶ãƒ¼æä¾›ã®URLã‚’ã‚µãƒ¼ãƒãƒ¼ãŒæ¤œè¨¼ãªã—ã«ãƒ•ã‚§ãƒƒãƒã™ã‚‹ã“ã¨ã§ã€å†…éƒ¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¸ã®ä¸æ­£ã‚¢ã‚¯ã‚»ã‚¹ãŒå¯èƒ½ã«ãªã‚‹è„†å¼±æ€§ã§ã™ã€‚</p>

    <div class="code-block">
      <div class="code-block-header">
        <span class="lang">JavaScript</span>
        <span>âœ… SSRFå¯¾ç­–</span>
      </div>
      <pre><span class="keyword">const</span> { URL } = <span class="function">require</span>(<span class="string">'url'</span>);

<span class="keyword">function</span> <span class="function">isAllowedUrl</span>(input) {
  <span class="keyword">try</span> {
    <span class="keyword">const</span> url = <span class="keyword">new</span> <span class="type">URL</span>(input);
    <span class="comment">// ãƒ—ãƒ­ãƒˆã‚³ãƒ«åˆ¶é™</span>
    <span class="keyword">if</span> (!['https:', 'http:'].<span class="function">includes</span>(url.protocol)) <span class="keyword">return false</span>;
    <span class="comment">// ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPç¯„å›²ã‚’ãƒ–ãƒ­ãƒƒã‚¯</span>
    <span class="keyword">const</span> blocked = [<span class="string">'127.0.0.1'</span>, <span class="string">'localhost'</span>, <span class="string">'0.0.0.0'</span>, <span class="string">'169.254.169.254'</span>];
    <span class="keyword">if</span> (blocked.<span class="function">includes</span>(url.hostname)) <span class="keyword">return false</span>;
    <span class="comment">// å†…éƒ¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç¯„å›²ãƒã‚§ãƒƒã‚¯ï¼ˆ10.x, 172.16-31.x, 192.168.xï¼‰</span>
    <span class="keyword">if</span> (/^(10\.|172\.(1[6-9]|2\d|3[01])\.|192\.168\.)/.test(url.hostname)) <span class="keyword">return false</span>;
    <span class="keyword">return true</span>;
  } <span class="keyword">catch</span> {
    <span class="keyword">return false</span>;
  }
}</pre>
    </div>
  </div>

  <!-- API8: Security Misconfiguration -->
  <div class="section">
    <h2><span class="section-icon">8ï¸âƒ£</span> API8:2023 - Security Misconfiguration</h2>
    <span class="badge badge-info">Medium</span>

    <h3>æ¦‚è¦</h3>
    <p>APIã‚µãƒ¼ãƒãƒ¼ã‚„ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®šãŒä¸é©åˆ‡ãªçŠ¶æ…‹ã€‚ä¸è¦ãªHTTPãƒ¡ã‚½ãƒƒãƒ‰ã®è¨±å¯ã€CORSã®éåº¦ãªç·©å’Œã€ãƒ‡ãƒãƒƒã‚°æƒ…å ±ã®éœ²å‡ºãªã©ã€‚</p>

    <div class="code-block">
      <div class="code-block-header">
        <span class="lang">JavaScript (Express)</span>
        <span>âœ… ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼è¨­å®š</span>
      </div>
      <pre><span class="keyword">const</span> helmet = <span class="function">require</span>(<span class="string">'helmet'</span>);
<span class="keyword">const</span> cors = <span class="function">require</span>(<span class="string">'cors'</span>);

app.<span class="function">use</span>(<span class="function">helmet</span>());
app.<span class="function">use</span>(<span class="function">cors</span>({
  <span class="variable">origin</span>: [<span class="string">'https://app.example.com'</span>], <span class="comment">// ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰ã¯ä½¿ã‚ãªã„</span>
  <span class="variable">methods</span>: [<span class="string">'GET'</span>, <span class="string">'POST'</span>, <span class="string">'PUT'</span>, <span class="string">'DELETE'</span>],
  <span class="variable">credentials</span>: <span class="keyword">true</span>,
}));

<span class="comment">// ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒ©: æœ¬ç•ªç’°å¢ƒã§ã¯ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’è¿”ã•ãªã„</span>
app.<span class="function">use</span>((err, req, res, next) =&gt; {
  res.<span class="function">status</span>(<span class="number">500</span>).<span class="function">json</span>({
    <span class="variable">error</span>: process.env.NODE_ENV === <span class="string">'production'</span>
      ? <span class="string">'Internal Server Error'</span>
      : err.message,
  });
});</pre>
    </div>
  </div>

  <!-- API9: Improper Inventory Management -->
  <div class="section">
    <h2><span class="section-icon">9ï¸âƒ£</span> API9:2023 - Improper Inventory Management</h2>
    <span class="badge badge-info">Medium</span>

    <h3>æ¦‚è¦</h3>
    <p>å¤ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãŒæ”¾ç½®ã•ã‚Œã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ‘ãƒƒãƒãŒé©ç”¨ã•ã‚Œãªã„ã¾ã¾å…¬é–‹ã•ã‚Œã¦ã„ã‚‹çŠ¶æ…‹ã€‚ã‚·ãƒ£ãƒ‰ã‚¦APIã‚„ã‚¾ãƒ³ãƒ“APIã¨ã‚‚å‘¼ã°ã‚Œã¾ã™ã€‚</p>

    <h3>å¯¾ç­–</h3>
    <ul class="checklist">
      <li>ã™ã¹ã¦ã®APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’æ–‡æ›¸åŒ–ãƒ»ç®¡ç†ï¼ˆOpenAPI/Swaggerï¼‰</li>
      <li>éæ¨å¥¨APIã«æ˜ç¢ºãªå»ƒæ­¢ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’è¨­å®š</li>
      <li>APIã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã§æœªç™»éŒ²ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ãƒ–ãƒ­ãƒƒã‚¯</li>
      <li>å®šæœŸçš„ãªAPIã‚¤ãƒ³ãƒ™ãƒ³ãƒˆãƒªç›£æŸ»ã‚’å®Ÿæ–½</li>
    </ul>
  </div>

  <!-- API10: Unsafe Consumption of APIs -->
  <div class="section">
    <h2><span class="section-icon">ğŸ”Ÿ</span> API10:2023 - Unsafe Consumption of APIs</h2>
    <span class="badge badge-info">Medium</span>

    <h3>æ¦‚è¦</h3>
    <p>ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£APIã‹ã‚‰ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’æ¤œè¨¼ã›ãšã«ä¿¡é ¼ã—ã¦ã—ã¾ã†è„†å¼±æ€§ã€‚å¤–éƒ¨APIãŒä¾µå®³ã•ã‚ŒãŸå ´åˆã€è‡ªã‚·ã‚¹ãƒ†ãƒ ã«ã‚‚å½±éŸ¿ãŒæ³¢åŠã—ã¾ã™ã€‚</p>

    <div class="code-block">
      <div class="code-block-header">
        <span class="lang">JavaScript</span>
        <span>âœ… å¤–éƒ¨APIãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®æ¤œè¨¼</span>
      </div>
      <pre><span class="keyword">const</span> Ajv = <span class="function">require</span>(<span class="string">'ajv'</span>);
<span class="keyword">const</span> ajv = <span class="keyword">new</span> <span class="type">Ajv</span>();

<span class="comment">// å¤–éƒ¨APIã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’ã‚¹ã‚­ãƒ¼ãƒã§æ¤œè¨¼</span>
<span class="keyword">const</span> externalSchema = {
  <span class="variable">type</span>: <span class="string">'object'</span>,
  <span class="variable">required</span>: [<span class="string">'id'</span>, <span class="string">'status'</span>],
  <span class="variable">properties</span>: {
    <span class="variable">id</span>: { <span class="variable">type</span>: <span class="string">'string'</span>, <span class="variable">maxLength</span>: <span class="number">50</span> },
    <span class="variable">status</span>: { <span class="variable">type</span>: <span class="string">'string'</span>, <span class="variable">enum</span>: [<span class="string">'active'</span>, <span class="string">'inactive'</span>] },
  },
  <span class="variable">additionalProperties</span>: <span class="keyword">false</span>,
};

<span class="keyword">const</span> validate = ajv.<span class="function">compile</span>(externalSchema);

<span class="keyword">async function</span> <span class="function">fetchExternalData</span>() {
  <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="function">fetch</span>(<span class="string">'https://api.external.com/data'</span>);
  <span class="keyword">const</span> data = <span class="keyword">await</span> res.<span class="function">json</span>();

  <span class="keyword">if</span> (!<span class="function">validate</span>(data)) {
    <span class="keyword">throw new</span> <span class="type">Error</span>(<span class="string">'External API response validation failed'</span>);
  }
  <span class="keyword">return</span> data;
}</pre>
    </div>
  </div>

  <!-- Summary Table -->
  <div class="section">
    <h2><span class="section-icon">ğŸ“Š</span> ä¸€è¦§è¡¨</h2>

    <div class="table-wrapper">
      <table>
        <thead>
          <tr>
            <th>ID</th>
            <th>è„†å¼±æ€§</th>
            <th>é‡è¦åº¦</th>
            <th>ä¸»ãªå¯¾ç­–</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>API1</td>
            <td>Broken Object Level Authorization</td>
            <td><span class="badge badge-danger">Critical</span></td>
            <td>ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ¬ãƒ™ãƒ«ã®èªå¯ãƒã‚§ãƒƒã‚¯</td>
          </tr>
          <tr>
            <td>API2</td>
            <td>Broken Authentication</td>
            <td><span class="badge badge-danger">Critical</span></td>
            <td>é©åˆ‡ãªãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç†ãƒ»ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹å¯¾ç­–</td>
          </tr>
          <tr>
            <td>API3</td>
            <td>Broken Object Property Level Authorization</td>
            <td><span class="badge badge-warning">High</span></td>
            <td>ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®æ˜ç¤ºçš„ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°</td>
          </tr>
          <tr>
            <td>API4</td>
            <td>Unrestricted Resource Consumption</td>
            <td><span class="badge badge-warning">High</span></td>
            <td>ãƒ¬ãƒ¼ãƒˆåˆ¶é™ãƒ»ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚µã‚¤ã‚ºåˆ¶é™</td>
          </tr>
          <tr>
            <td>API5</td>
            <td>Broken Function Level Authorization</td>
            <td><span class="badge badge-warning">High</span></td>
            <td>ãƒ­ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã®ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡</td>
          </tr>
          <tr>
            <td>API6</td>
            <td>Unrestricted Access to Sensitive Business Flows</td>
            <td><span class="badge badge-info">Medium</span></td>
            <td>CAPTCHAãƒ»ãƒ“ã‚¸ãƒã‚¹ãƒ¬ãƒ™ãƒ«ã®åˆ¶é™</td>
          </tr>
          <tr>
            <td>API7</td>
            <td>Server Side Request Forgery</td>
            <td><span class="badge badge-warning">High</span></td>
            <td>URLæ¤œè¨¼ãƒ»ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPãƒ–ãƒ­ãƒƒã‚¯</td>
          </tr>
          <tr>
            <td>API8</td>
            <td>Security Misconfiguration</td>
            <td><span class="badge badge-info">Medium</span></td>
            <td>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ãƒ»CORSè¨­å®š</td>
          </tr>
          <tr>
            <td>API9</td>
            <td>Improper Inventory Management</td>
            <td><span class="badge badge-info">Medium</span></td>
            <td>APIã‚¤ãƒ³ãƒ™ãƒ³ãƒˆãƒªç®¡ç†ãƒ»å»ƒæ­¢ãƒãƒªã‚·ãƒ¼</td>
          </tr>
          <tr>
            <td>API10</td>
            <td>Unsafe Consumption of APIs</td>
            <td><span class="badge badge-info">Medium</span></td>
            <td>å¤–éƒ¨APIãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ã‚¹ã‚­ãƒ¼ãƒæ¤œè¨¼</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

<script src="js/common.js"></script>
</body>
</html>
