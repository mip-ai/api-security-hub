<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>API Security Reference Hub</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>

  <!-- Hero -->
  <div class="hero">
    <h1>API Security Reference Hub</h1>
    <p>APIセキュリティに関する知識を一箇所に集約。<br>開発チームのための実用的なリファレンスサイト。</p>
    <div class="stats-row">
      <div class="stat-item">
        <div class="stat-number">10</div>
        <div class="stat-label">OWASP Top 10 脆弱性</div>
      </div>
      <div class="stat-item">
        <div class="stat-number">6</div>
        <div class="stat-label">セクション</div>
      </div>
      <div class="stat-item">
        <div class="stat-number">50+</div>
        <div class="stat-label">チェック項目</div>
      </div>
    </div>
  </div>

  <!-- Latest News (auto-updated from RSS feeds) -->
  <div class="section">
    <h2><span class="section-icon">🔥</span> APIセキュリティ最新ニュース</h2>
    <p id="news-updated" class="text-muted" style="font-size:0.8rem;"></p>
    <div id="news-container">
      <p class="text-muted">ニュースを読み込み中...</p>
    </div>
    <div style="margin-top:16px;">
      <a href="news.html">すべてのニュース・トレンドを見る →</a>
    </div>
  </div>

  <!-- Section Navigation -->
  <div class="section">
    <h2><span class="section-icon">📚</span> コンテンツ</h2>
    <p>各セクションをクリックして詳細を確認できます。</p>

    <div class="highlight-cards">
      <a href="owasp-top10.html" class="card-link">
        <div class="highlight-card">
          <div class="hl-icon">🔟</div>
          <h3>OWASP API Top 10</h3>
          <p>最も重要な10の脆弱性と対策コード例</p>
        </div>
      </a>
      <a href="auth.html" class="card-link">
        <div class="highlight-card">
          <div class="hl-icon">🔐</div>
          <h3>認証・認可</h3>
          <p>OAuth2.0 / JWT / APIキー管理</p>
        </div>
      </a>
      <a href="rate-limiting.html" class="card-link">
        <div class="highlight-card">
          <div class="hl-icon">⚡</div>
          <h3>レート制限・入力検証</h3>
          <p>レート制限 / バリデーション / CORS</p>
        </div>
      </a>
      <a href="tools.html" class="card-link">
        <div class="highlight-card">
          <div class="hl-icon">🛠</div>
          <h3>セキュリティツール</h3>
          <p>Burp Suite / ZAP / Postman 他</p>
        </div>
      </a>
      <a href="guidelines.html" class="card-link">
        <div class="highlight-card">
          <div class="hl-icon">📋</div>
          <h3>社内ガイドライン</h3>
          <p>チェックリスト / レビュー観点</p>
        </div>
      </a>
      <a href="news.html" class="card-link">
        <div class="highlight-card">
          <div class="hl-icon">📰</div>
          <h3>最新情報</h3>
          <p>脆弱性ニュース / CVE / トレンド</p>
        </div>
      </a>
    </div>
  </div>

  <!-- Quick Reference -->
  <div class="section">
    <h2><span class="section-icon">⚡</span> クイックリファレンス</h2>
    <p>APIセキュリティの基本原則</p>

    <div class="card-grid">
      <div class="card">
        <h3>🔒 最小権限の原則</h3>
        <p>APIアクセスは必要最小限の権限のみ付与。ロールベースのアクセス制御（RBAC）を実装する。</p>
      </div>
      <div class="card">
        <h3>🛡 多層防御</h3>
        <p>認証・認可・入力検証・レート制限・ログ監視を組み合わせ、単一障害点を排除する。</p>
      </div>
      <div class="card">
        <h3>📝 ゼロトラスト</h3>
        <p>すべてのリクエストを検証。内部ネットワークからのアクセスも信頼しない。</p>
      </div>
      <div class="card">
        <h3>🔍 可観測性</h3>
        <p>すべてのAPIアクセスをログに記録し、異常検知・監査証跡を確保する。</p>
      </div>
    </div>
  </div>

  <!-- OWASP Top 3 Highlight -->
  <div class="section">
    <h2><span class="section-icon">🚨</span> 注目すべき脆弱性 Top 3</h2>
    <p>OWASP API Security Top 10 から特に重要度の高い3項目をピックアップ。<a href="owasp-top10.html">全項目を見る →</a></p>

    <div class="card-grid">
      <div class="card">
        <h3>API1 - 認可の不備 (BOLA)</h3>
        <p>他のユーザーのリソースに不正アクセスできてしまう脆弱性。最も頻出かつ影響の大きい問題。</p>
        <span class="card-tag tag-critical">Critical</span>
      </div>
      <div class="card">
        <h3>API2 - 認証の不備</h3>
        <p>認証メカニズムの実装ミスにより、攻撃者が他ユーザーのIDを乗っ取れる脆弱性。</p>
        <span class="card-tag tag-critical">Critical</span>
      </div>
      <div class="card">
        <h3>API3 - オブジェクトプロパティレベル認可の不備</h3>
        <p>APIが返すオブジェクト内の機密プロパティへのアクセス制御が不十分な脆弱性。</p>
        <span class="card-tag tag-high">High</span>
      </div>
    </div>
  </div>

  <!-- Getting Started -->
  <div class="section">
    <h2><span class="section-icon">🚀</span> はじめに</h2>

    <div class="callout callout-info">
      <div class="callout-title">このサイトの使い方</div>
      <p>左のサイドバー（モバイルではハンバーガーメニュー）から各セクションに移動できます。初めての方は OWASP Top 10 → 認証・認可 → レート制限 の順で読み進めることを推奨します。</p>
    </div>

    <div class="callout callout-warning">
      <div class="callout-title">免責事項</div>
      <p>本サイトの情報はセキュリティ啓発・防御目的で提供されています。攻撃目的での利用は禁止します。記載内容は2025年時点の情報に基づいています。</p>
    </div>
  </div>

<script src="js/common.js"></script>
<script>
(function() {
  const container = document.getElementById('news-container');
  const updatedEl = document.getElementById('news-updated');
  if (!container) return;

  fetch('data/news.json')
    .then(res => {
      if (!res.ok) throw new Error('not found');
      return res.json();
    })
    .then(data => {
      if (!data.items || data.items.length === 0) {
        container.innerHTML = '<p class="text-muted">現在取得できるニュースはありません。次回の自動更新をお待ちください。</p>';
        return;
      }

      // Show last updated time in JST
      if (data.lastUpdated) {
        const d = new Date(data.lastUpdated);
        const jst = d.toLocaleString('ja-JP', { timeZone: 'Asia/Tokyo' });
        updatedEl.textContent = '最終更新: ' + jst;
      }

      // Display up to 5 items
      const items = data.items.slice(0, 5);
      container.innerHTML = items.map(item => {
        const date = item.pubDate
          ? new Date(item.pubDate).toLocaleDateString('ja-JP', { timeZone: 'Asia/Tokyo', month: 'short', day: 'numeric' })
          : '';
        return '<div class="news-item">' +
          '<div class="news-meta">' +
            '<span class="badge badge-info">' + (item.source || '') + '</span>' +
            '<span>' + date + '</span>' +
          '</div>' +
          '<h3><a href="' + item.link + '" target="_blank" rel="noopener">' + item.title + '</a></h3>' +
          '<p>' + (item.description || '') + '</p>' +
        '</div>';
      }).join('');
    })
    .catch(() => {
      container.innerHTML = '<p class="text-muted">ニュースデータはまだ生成されていません。GitHub Actions による初回更新をお待ちください。</p>';
    });
})();
</script>
</body>
</html>
